<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Aquaculture Aâ€“Z â€¢ Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class',theme:{extend:{boxShadow:{soft:'0 12px 28px rgba(2,6,23,.08)'}}}}
  </script>
  <style>
    html{scroll-behavior:smooth}
    body{background:linear-gradient(135deg,#dbeafe 0%,#e0f2fe 50%,#f0fdf4 100%)}
    .dark body{background:linear-gradient(135deg,#0f172a 0%,#082f49 50%,#14532d 100%)}

    .navbtn{border:1px solid rgb(226,232,240);padding:.55rem .9rem;border-radius:.75rem;
            background:#fff;text-align:center;font-weight:700;font-size:1rem;white-space:nowrap;}
    @media (min-width:640px){ .navbtn{font-size:.95rem;padding:.6rem 1rem} }
    .dark .navbtn{background:#0b1220;border-color:#1f2937}

    .ticker{overflow:hidden;mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent);
            -webkit-mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent)}
    .ticker-track{display:flex;gap:24px;white-space:nowrap;min-width:max-content;animation:ticker 20s linear infinite}
    @keyframes ticker{from{transform:translateX(0)} to{transform:translateX(-50%)}}

    @keyframes blink{0%,100%{opacity:1;background-color:#facc15;color:#111827}
                     50%{opacity:1;background-color:#dc2626;color:#fff}}
    .blink{animation:blink 1.2s infinite}

    .promo-dot{height:.5rem;width:.5rem;border-radius:9999px;border:1px solid currentColor;opacity:.5}
    .promo-dot.active{opacity:1;background:currentColor}
    .promo-slide{display:none}
    .promo-slide.active{display:block}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100">

  <!-- Header -->
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center">
      <!-- Logo -->
      <div class="h-9 w-9 mr-1 relative">
        <img src="assets/logo.png" alt="Logo" class="h-9 w-9 object-contain block dark:hidden">
        <img src="assets/logo-dark.png" alt="Logo" class="h-9 w-9 object-contain hidden dark:block">
      </div>
      <h1 class="text-xl font-bold hidden sm:inline">Aquaculture Aâ€“Z</h1>
      <h1 class="text-xl font-bold sm:hidden mr-14 sm:mr-0">Aquaa Aâ€“Z</h1>

      <!-- Nav -->
      <nav class="hidden sm:flex gap-2 flex-1 justify-center">
        <a href="index.html"   class="navbtn">ğŸ  <span data-i18n="m_home">Home</span></a>
        <a href="harvest.html" class="navbtn">ğŸšš <span data-i18n="t_harvest">Harvest</span></a>
        <a href="seeds.html"   class="navbtn">ğŸ¦ <span data-i18n="t_seeds">Seeds</span></a>
        <a href="vendors.html" class="navbtn">ğŸª <span data-i18n="t_dealers">Dealers</span></a>
        <a href="seeds.html"   class="navbtn">ğŸ¦ <span data-i18n="m_shrimp">Shrimp</span></a>
        <a href="contact.html" class="navbtn">ğŸ“ <span data-i18n="contact">Contact</span></a>
      </nav>

      <!-- Right Controls -->
      <div class="flex items-center gap-2 flex-none">
        <label for="langSel" class="text-sm text-slate-600 dark:text-slate-300 select-none">Ln</label>
        <select id="langSel" class="text-sm border rounded-md px-2 py-1 dark:bg-slate-900 dark:border-slate-700">
          <option value="te">à°¤à±†à°²à±à°—à±</option>
          <option value="en">English</option>
        </select>
        <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border">ğŸŒ™/â˜€ï¸</button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-3 sm:p-4 space-y-4 pb-24 sm:pb-4">

    <!-- Flash News -->
    <section class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border">
      <div class="flex items-center justify-between">
        <h3 class="font-semibold">ğŸ“° <span data-i18n="flash_news">Flash News</span></h3>
        <span class="text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-700">Live</span>
      </div>
      <div class="mt-3 ticker"><div id="newsTrackTop" class="ticker-track"></div></div>
      <p class="text-xs text-slate-500 mt-2"><span data-i18n="updated">Updated</span>: <span id="newsUpdatedTop">â€”</span></p>
    </section>

    <!-- Rates + Promotions -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-4">
      <!-- Rates -->
      <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border">
        <div class="flex items-center justify-between">
          <h3 class="font-semibold" data-i18n="snapshot">Live Snapshot</h3>
          <p class="text-xs text-slate-500"><span data-i18n="updated">Updated</span>: <span id="updatedAt">â€”</span></p>
        </div>

        <div class="mt-2 overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="border-b dark:border-slate-800 text-slate-500">
                <th class="text-left py-2 pr-4">Count</th>
                <th class="text-left py-2 pr-4">Price (â‚¹/kg)
                  <select id="prawnType" class="ml-2 text-sm border rounded-md px-2 py-1 dark:bg-slate-800"></select>
                </th>
                <th class="text-left py-2 pr-4">Change</th>
              </tr>
            </thead>
            <tbody id="ratesBody"></tbody>
          </table>
        </div>
      </div>

      <!-- Promotions -->
      <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border">
        <div class="flex items-center justify-between">
          <h3 class="font-semibold">ğŸ“£ <span data-i18n="promotions_title">Promotions</span></h3>
        </div>
        <div id="promoSlider" class="relative mt-3">
          <div id="promoTrack" class="overflow-hidden rounded-xl"></div>
          <div id="promoDots" class="mt-3 flex gap-2"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom Nav -->
  <nav class="fixed bottom-0 inset-x-0 bg-white dark:bg-slate-900 border-t flex justify-around py-2 sm:hidden">
    <a href="index.html" class="flex flex-col items-center text-base font-semibold"><span>ğŸ </span><span>Home</span></a>
    <a href="harvest.html" class="flex flex-col items-center text-base font-semibold"><span>ğŸ•˜</span><span>History</span></a>
    <a href="seeds.html" class="flex flex-col items-center text-base font-semibold"><span>ğŸ¦</span><span>Shrimp</span></a>
  </nav>

  <script>
    const $id = s=>document.getElementById(s);

    async function loadCSV(url){
      const res = await fetch(url,{cache:'no-store'});
      const text = await res.text();
      const lines = text.trim().split(/\r?\n/);
      const headers = lines[0].split(',');
      return lines.slice(1).map(l=>{
        const c=l.split(',');
        let o={}; headers.forEach((h,i)=>o[h]=c[i]); return o;
      });
    }

    function badge(d){
      if(d>0) return `<span class="text-green-600">â–² +â‚¹${d}</span>`;
      if(d<0) return `<span class="text-red-600">â–¼ â‚¹${Math.abs(d)}</span>`;
      return `â€”`;
    }

    async function renderRates(type){
      const body=$id('ratesBody');
      const current=await loadCSV('./data/rates.csv');
      const rows=current.filter(r=>r.Type===type);
      body.innerHTML='';
      rows.forEach(r=>{
        body.innerHTML+=`<tr><td class="py-2 pr-4">${r.Count}c</td>
                          <td class="py-2 pr-4">â‚¹ ${r.Price}</td>
                          <td class="py-2 pr-4">${badge(+r.Change)}</td></tr>`;
      });
      $id('updatedAt').textContent=new Date().toLocaleString();
    }

    async function renderPromos(){
      const csv=await loadCSV('./data/promotions.csv');
      let promos=csv||[];
      const track=$id('promoTrack'); const dots=$id('promoDots');
      if(!promos.length) promos=[{Title:"Seeds Batch 1",Desc:"Vannamei SPF 30% bonus"}];
      track.innerHTML=promos.map((r,i)=>`<div class="promo-slide p-4 ${i===0?'active':''}">${r.Title}<br>${r.Desc}</div>`).join('');
      dots.innerHTML=promos.map((_,i)=>`<button class="promo-dot ${i===0?'active':''}"></button>`).join('');
    }

    document.addEventListener('DOMContentLoaded',async()=>{
      const sel=$id('prawnType');
      sel.innerHTML='<option value="Vannamei">Vannamei</option><option value="Tiger">Tiger</option>';
      sel.onchange=()=>renderRates(sel.value);
      renderRates('Vannamei');
      renderPromos();
    });
  </script>
</body>
</html>
