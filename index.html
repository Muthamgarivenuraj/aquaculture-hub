<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Aquaculture A–Z • Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class',theme:{extend:{boxShadow:{soft:'0 12px 28px rgba(2,6,23,.08)'}}}}
  </script>
  <style>
    body{background:linear-gradient(135deg,#dbeafe 0,#e0f2fe 50%,#f0fdf4 100%)}
    .dark body{background:linear-gradient(135deg,#0f172a 0,#082f49 50%,#14532d 100%)}
    .navbtn{border:1px solid rgb(226,232,240);padding:.55rem .9rem;border-radius:.75rem;background:#fff;text-align:center;font-weight:700;font-size:1rem;white-space:nowrap;}
    @media (min-width:640px){ .navbtn{font-size:.95rem;padding:.6rem 1rem} }
    .dark .navbtn{background:#0b1220;border-color:#1f2937}
    .ticker{overflow:hidden;mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent);-webkit-mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent)}
    .ticker-track{display:flex;gap:24px;white-space:nowrap;min-width:max-content;animation:ticker 20s linear infinite}
    @keyframes ticker{from{transform:translateX(0)} to{transform:translateX(-50%)}}
    @media (max-width:640px){.ticker{mask-image:none;-webkit-mask-image:none}.ticker-track{gap:16px;animation-duration:28s}}
    .promo-dot{height:.5rem;width:.5rem;border-radius:9999px;border:1px solid currentColor;opacity:.5}
    .promo-dot.active{opacity:1;background:currentColor}
    .promo-slide{display:none}
    .promo-slide.active{display:block}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100">
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center">
      <div class="h-9 w-9 mr-1 relative">
        <img src="assets/logo.png" class="h-9 w-9 object-contain block dark:hidden">
        <img src="assets/logo-dark.png" class="h-9 w-9 object-contain hidden dark:block">
      </div>
      <h1 class="text-xl font-bold hidden sm:inline">Aquaculture A–Z</h1>
      <h1 class="text-xl font-bold sm:hidden mr-14">Aquaa A–Z</h1>
      <nav class="hidden sm:flex gap-2 flex-1 justify-center">
        <a href="index.html" class="navbtn">🏠 Home</a>
        <a href="harvest.html" class="navbtn">🚚 Harvest</a>
        <a href="seeds.html" class="navbtn">🦐 Seeds</a>
        <a href="vendors.html" class="navbtn">🏪 Dealers</a>
        <a href="seeds.html" class="navbtn">🦐 Shrimp</a>
        <a href="contact.html" class="navbtn">📞 Contact</a>
      </nav>
      <div class="flex items-center gap-2">
        <select id="langSel" class="text-sm border rounded-md px-2 py-1 dark:bg-slate-900 dark:border-slate-700">
          <option value="te">తెలుగు</option>
          <option value="en">English</option>
        </select>
        <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border dark:border-slate-800">🌙/☀️</button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-3 sm:p-4 space-y-4 pb-24 sm:pb-4">

    <!-- Rates -->
    <section class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border">
      <h3 class="font-semibold">📊 Live Snapshot</h3>
      <div class="overflow-x-auto mt-2">
        <table class="min-w-full text-sm" id="ratesTable">
          <thead>
            <tr class="border-b text-slate-500">
              <th class="text-left py-2">Count</th>
              <th class="text-left py-2">
                <div class="flex flex-col">
                  <span>Price (₹/kg)</span>
                  <select id="prawnType" class="mt-1 text-sm border rounded-md px-2 py-1 dark:bg-slate-800"></select>
                </div>
              </th>
              <th class="text-left py-2">Change</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="text-xs text-slate-500 mt-2">Updated: <span id="updatedAt">—</span></p>
    </section>

  </main>

  <script>
    const $id = s=>document.getElementById(s);

    async function loadCSV(url){
      const res=await fetch(url,{cache:"no-store"});
      const text=await res.text();
      const lines=text.trim().split(/\r?\n/);
      const headers=lines[0].split(',');
      return lines.slice(1).map(l=>{
        const vals=l.split(',');
        const o={}; headers.forEach((h,i)=>o[h]=vals[i]); return o;
      });
    }

    // Load Rates CSV
    async function loadRates(){
      const data=await loadCSV("data/rates.csv");
      const types=[...new Set(data.map(d=>d.type))];
      const sel=$id("prawnType");
      sel.innerHTML=types.map(t=>`<option>${t}</option>`).join('');
      sel.onchange=()=>renderRates(sel.value,data);
      renderRates(types[0],data);
    }

    function renderRates(type,data){
      const body=$id("ratesTable").querySelector("tbody"); body.innerHTML="";
      const rows=data.filter(r=>r.type===type);
      rows.forEach(r=>{
        const diff=r.current_price-r.previous_price;
        const badge=diff>0?`<span class="text-emerald-600">▲ +₹${diff}</span>`:diff<0?`<span class="text-rose-600">▼ ₹${Math.abs(diff)}</span>`:`—`;
        body.innerHTML+=`<tr><td>${r.count}c</td><td>₹ ${r.current_price}</td><td>${badge}</td></tr>`;
      });
      $id("updatedAt").textContent=new Date().toLocaleString();
    }

    document.addEventListener("DOMContentLoaded",()=>{
      loadRates();
      $id("themeToggle").onclick=()=>document.documentElement.classList.toggle("dark");
    });
  </script>
</body>
</html>
