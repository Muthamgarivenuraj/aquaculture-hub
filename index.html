<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Aquaculture A–Z • Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={darkMode:'class',theme:{extend:{boxShadow:{soft:'0 12px 28px rgba(2,6,23,.08)'}}}}</script>
  <style>
    html{scroll-behavior:smooth}
    body{background:linear-gradient(135deg,#dbeafe 0%,#e0f2fe 50%,#f0fdf4 100%)}
    .dark body{background:linear-gradient(135deg,#0f172a 0%,#082f49 50%,#14532d 100%)}
    .navbtn{ @apply rounded-xl px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 }
    /* Flash news ticker (mobile friendly) */
    .ticker{overflow:hidden;mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent);-webkit-mask-image:linear-gradient(90deg,transparent,black 8%,black 92%,transparent)}
    .ticker-track{display:flex;gap:24px;white-space:nowrap;min-width:max-content;animation:ticker 20s linear infinite}
    @keyframes ticker{from{transform:translateX(0)} to{transform:translateX(-50%)}}
    @media (max-width:640px){.ticker{mask-image:none;-webkit-mask-image:none}.ticker-track{gap:16px;animation-duration:28s}}
    /* Harvest-only blink for tag chip */
    @keyframes blink{0%,100%{opacity:1;background-color:#facc15;color:#111827}50%{opacity:1;background-color:#dc2626;color:#fff}}
    .blink{animation:blink 1.2s infinite}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100">
  <!-- Header -->
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3">
      <h1 class="text-xl font-bold flex-1" data-i18n="app_title">Aquaculture A–Z</h1>
      <nav class="hidden sm:flex gap-2">
        <a href="harvest.html" class="navbtn">🚚 <span data-i18n="t_harvest">Harvest</span></a>
        <a href="seeds.html" class="navbtn">🦐 <span data-i18n="t_seeds">Seeds</span></a>
        <a href="dealers.html" class="navbtn">🏪 <span data-i18n="t_dealers">Dealers</span></a>
      </nav>
      <div class="flex rounded-full bg-slate-100 dark:bg-slate-900 p-1 border border-slate-200 dark:border-slate-800">
        <button id="langTE" class="px-3 py-1.5 text-sm rounded-full bg-white dark:bg-slate-800 shadow-soft">తెలుగు</button>
        <button id="langEN" class="px-3 py-1.5 text-sm rounded-full">English</button>
      </div>
      <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border border-slate-200 dark:border-slate-800">🌙/☀️</button>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 space-y-4">
    <!-- Flash News -->
    <section class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800">
      <div class="flex items-center justify-between">
        <h3 class="font-semibold">📰 <span data-i18n="flash_news">Flash News</span></h3>
        <span class="text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-200">Live</span>
      </div>
      <div class="mt-3 ticker"><div id="newsTrackTop" class="ticker-track"></div></div>
      <p class="text-xs text-slate-500 mt-2"><span data-i18n="updated">Updated</span>: <span id="newsUpdatedTop">—</span></p>
    </section>

    <!-- Rates Snapshot -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-4">
      <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800">
        <div class="flex items-center justify-between">
          <h3 class="font-semibold" data-i18n="snapshot">Live Snapshot</h3>
          <p class="text-xs text-slate-500"><span data-i18n="updated">Updated</span>: <span id="updatedAt">—</span></p>
        </div>
        <div class="mt-3 overflow-x-auto">
          <table class="min-w-full text-sm" id="ratesTable">
            <thead>
              <tr class="border-b dark:border-slate-800 text-slate-500">
                <th class="text-left py-2 pr-4" data-i18n="th_count">Count</th>
                <th class="text-left py-2 pr-4" data-i18n="th_price">Price (₹/kg)</th>
                <th class="text-left py-2 pr-4" data-i18n="th_change">Change</th>
              </tr>
            </thead><tbody></tbody>
          </table>
        </div>
      </div>

      <!-- Promotions -->
      <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800">
        <div class="flex items-center justify-between">
          <h3 class="font-semibold">📣 Promotions</h3>
          <span class="text-xs px-2 py-1 rounded-full bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-200">NEW</span>
        </div>
        <ul class="mt-3 grid gap-2 text-sm">
          <li class="rounded-xl p-3 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800">🧊 Ice — ₹1200/ton</li>
          <li class="rounded-xl p-3 bg-sky-50 dark:bg-sky-900/20 border border-sky-200 dark:border-sky-800">🚚 5T Van — ₹22/km</li>
          <li class="rounded-xl p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800">🧬 Seeds — Batch 1 Open</li>
        </ul>
      </div>
    </section>

    <!-- Quick Nav (mobile) -->
    <section class="grid grid-cols-3 gap-2 sm:hidden">
      <a href="harvest.html" class="navbtn text-center">🚚 <span data-i18n="t_harvest">Harvest</span></a>
      <a href="seeds.html" class="navbtn text-center">🦐 <span data-i18n="t_seeds">Seeds</span></a>
      <a href="dealers.html" class="navbtn text-center">🏪 <span data-i18n="t_dealers">Dealers</span></a>
    </section>
  </main>

  <script>
    // i18n
    const dict={en:{app_title:"Aquaculture A–Z",t_harvest:"Harvest",t_seeds:"Seeds",t_dealers:"Dealers",flash_news:"Flash News",snapshot:"Live Snapshot",updated:"Updated",th_count:"Count",th_price:"Price (₹/kg)",th_change:"Change"},
               te:{app_title:"Aquaculture A–Z",t_harvest:"హార్వెస్ట్",t_seeds:"సీడ్స్",t_dealers:"వెండర్లు",flash_news:"ఫ్లాష్ న్యూస్",snapshot:"లైవ్ స్నాప్‌షాట్",updated:"అప్‌డేట్",th_count:"కౌంట్",th_price:"ధర (₹/kg)",th_change:"మార్పు"}};
    function setLang(){const lang=localStorage.getItem('lang')||'te';document.documentElement.lang=lang;document.querySelectorAll('[data-i18n]').forEach(el=>{el.textContent=dict[lang][el.dataset.i18n]||el.textContent});}
    document.getElementById('langEN').onclick=()=>{localStorage.setItem('lang','en');setLang();loadNews()};
    document.getElementById('langTE').onclick=()=>{localStorage.setItem('lang','te');setLang();loadNews()};

    // Theme
    const themeToggle=document.getElementById('themeToggle');
    const savedTheme=localStorage.getItem('theme');
    if(savedTheme==='dark'||(!savedTheme&&matchMedia('(prefers-color-scheme: dark)').matches)) document.documentElement.classList.add('dark');
    themeToggle.onclick=()=>{document.documentElement.classList.toggle('dark');localStorage.setItem('theme',document.documentElement.classList.contains('dark')?'dark':'light');};

    // Rates fixed scale (150c..50c)
    function loadRates(){
      const counts=[150,140,130,120,110,100,90,80,70,60,50];
      const priceByCount=c=>{
        if(c>=110) return 240 - ((c-100)/10)*10;
        if(c===100) return 240;
        if(c===90) return 250;
        if(c===80) return 270;
        if(c===70) return 290;
        if(c===60) return 310;
        if(c===50) return 330;
        return 240;
      };
      const tbody=document.querySelector('#ratesTable tbody'); tbody.innerHTML='';
      counts.forEach(c=>{const tr=document.createElement('tr');tr.className='border-b last:border-0 dark:border-slate-800';
        tr.innerHTML=`<td class="py-2 pr-4 font-medium">${c}c</td><td class="py-2 pr-4">₹ ${priceByCount(c)}</td><td class="py-2 pr-4">—</td>`;tbody.appendChild(tr);});
      document.getElementById('updatedAt').textContent=new Intl.DateTimeFormat('en-IN',{dateStyle:'medium',timeStyle:'short'}).format(new Date());
    }

    // Flash News (Harvest-only blink)
    const NEWS_FALLBACK={en:[{tag:'Rates',text:'50c steady across coastal AP'},{tag:'Seed',text:'Batch 1 PL open this week'},{tag:'Harvest',text:'Night DO risk; add aeration 8pm–3am'},{tag:'Market',text:'Ice ₹1200/ton in Nellore'}],
                         te:[{tag:'రేట్స్',text:'50 కౌంట్ ధర స్థిరంగా ఉంది'},{tag:'సీడ్స్',text:'బ్యాచ్ 1 PL ఈ వారం ఓపెన్'},{tag:'హార్వెస్ట్',text:'రాత్రి DO రిస్క్ — 8pm–3am ఎయరేషన్ పెంచండి'},{tag:'మార్కెట్',text:'నెల్లూరు ఐస్ ₹1200/టన్'}]};
    function loadNews(){
      const track=document.getElementById('newsTrackTop'); const lang=localStorage.getItem('lang')||'te';
      let items=NEWS_FALLBACK[lang];
      if(items.length<3){items=items.concat(NEWS_FALLBACK[lang]).slice(0,3);}
      const matchHarvest=tag=>String(tag||'').trim().toLowerCase().replace(/\s+/g,'').includes('harvest')||String(tag||'').includes('హార్వెస్ట్');
      const chip=(t,b=false)=>`<span class="px-2 py-0.5 rounded-full bg-sky-100 text-sky-700 dark:bg-sky-900/40 dark:text-sky-200 text-[11px] ${b?'blink':''}">${t}</span>`;
      const row=items.map(n=>`<div class="flex items-center gap-2 pr-4">${chip(n.tag,matchHarvest(n.tag))}<span>${n.text}</span></div>`).join('');
      track.innerHTML=row+row+row;
      document.getElementById('newsUpdatedTop').textContent=new Intl.DateTimeFormat('en-IN',{dateStyle:'medium',timeStyle:'short'}).format(new Date());
    }

    // INIT
    setLang(); loadRates(); loadNews();
  </script>
</body>
</html>
