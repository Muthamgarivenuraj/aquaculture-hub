<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aquaculture A‚ÄìZ ‚Ä¢ Vendors & Culture</title>
  <meta name="description" content="Vendors directory with category & district filters and prawn culture guides. TE/EN + dark mode." />
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode:'class',
      theme:{ extend:{ boxShadow:{soft:'0 12px 28px rgba(2,6,23,.08)'} } }
    }
  </script>
  <style>
    html{scroll-behavior:smooth}
    body{background: linear-gradient(135deg,#dbeafe 0%,#e0f2fe 50%,#f0fdf4 100%)}
    .dark body{background: linear-gradient(135deg,#0f172a 0%,#082f49 50%,#14532d 100%)}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100 overflow-x-hidden">
  <!-- Top Bar -->
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="h-9 w-9 rounded-xl overflow-hidden shadow-soft">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" class="h-full w-full" aria-hidden="true">
          <defs><linearGradient id="g1" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#60a5fa"/><stop offset="100%" stop-color="#34d399"/></linearGradient></defs>
          <rect rx="14" ry="14" width="64" height="64" fill="url(#g1)"/>
          <g fill="#fff" opacity="0.95"><path d="M46 20c-6-2-13 1-17 6-4 5-5 12-1 16 4 4 10 3 14-1 3-3 4-7 3-11-4 1-8 0-11-2 4-1 8-2 12-8z"/><circle cx="42" cy="24" r="2"/></g>
        </svg>
      </div>
      <div>
        <h1 class="text-lg font-bold" data-i18n="title"></h1>
        <p class="text-xs text-slate-500" data-i18n="subtitle"></p>
      </div>
      <div class="ml-auto flex items-center gap-2">
        <div class="flex rounded-full bg-slate-100 dark:bg-slate-900 p-1 border border-slate-200 dark:border-slate-800">
          <button id="langTE" class="px-3 py-1.5 text-sm rounded-full bg-white dark:bg-slate-800 shadow-soft">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
          <button id="langEN" class="px-3 py-1.5 text-sm rounded-full">English</button>
        </div>
        <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border border-slate-200 dark:border-slate-800">üåô/‚òÄÔ∏è</button>
        <a href="./index.html" class="px-3 py-1.5 text-sm rounded-full border border-slate-200 dark:border-slate-800">‚Üê <span data-i18n="back_home"></span></a>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 space-y-4">
    <!-- Toggle + Filters -->
    <div class="flex flex-wrap items-center gap-2">
      <div class="inline-flex rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800">
        <button id="btnVendors" class="px-4 py-2 text-sm bg-emerald-600 text-white"><span data-i18n="vendors"></span></button>
        <button id="btnCulture" class="px-4 py-2 text-sm bg-white dark:bg-slate-900"><span data-i18n="culture"></span></button>
      </div>

      <!-- Filters for Vendors -->
      <div id="vendorFilters" class="flex flex-col sm:flex-row sm:items-center gap-2 sm:ml-auto w-full sm:w-auto">
        <select id="fCategory" class="w-full sm:w-44 rounded-md border px-2 py-2 text-sm dark:bg-slate-950 dark:border-slate-800">
          <option value="">{All}</option>
        </select>
        <select id="fDistrict" class="w-full sm:w-44 rounded-md border px-2 py-2 text-sm dark:bg-slate-950 dark:border-slate-800">
          <option value="">{All}</option>
        </select>
        <input id="fSearch" class="w-full sm:w-60 rounded-md border px-3 py-2 text-sm dark:bg-slate-950 dark:border-slate-800" data-i18n-placeholder="search_ph" />
      </div>
    </div>

    <!-- Vendors (compact: Name + Mobile only) -->
    <section id="v-vendors" class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800">
      <div class="overflow-x-hidden">
        <table class="w-full text-sm" id="dealersTable">
          <thead>
            <tr class="border-b dark:border-slate-800 text-slate-500">
              <th class="text-left py-2 pr-4" data-i18n="th_name"></th>
              <th class="text-left py-2 pr-0" data-i18n="th_mobile"></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- Prawn Culture -->
    <section id="v-culture" class="hidden rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800">
      <h3 class="font-semibold text-lg mb-3" data-i18n="culture_title"></h3>
      <div class="divide-y divide-slate-200 dark:divide-slate-800">
        <details class="py-3" open>
          <summary class="cursor-pointer font-medium" data-i18n="c_pond_title"></summary>
          <ul class="list-disc pl-6 mt-2 text-sm leading-relaxed" id="c_pond_list"></ul>
        </details>
        <details class="py-3">
          <summary class="cursor-pointer font-medium" data-i18n="c_stock_title"></summary>
          <ul class="list-disc pl-6 mt-2 text-sm" id="c_stock_list"></ul>
        </details>
        <details class="py-3">
          <summary class="cursor-pointer font-medium" data-i18n="c_water_title"></summary>
          <ul class="list-disc pl-6 mt-2 text-sm" id="c_water_list"></ul>
        </details>
        <details class="py-3">
          <summary class="cursor-pointer font-medium" data-i18n="c_health_title"></summary>
          <ul class="list-disc pl-6 mt-2 text-sm" id="c_health_list"></ul>
        </details>
        <details class="py-3">
          <summary class="cursor-pointer font-medium" data-i18n="c_harvest_title"></summary>
          <ul class="list-disc pl-6 mt-2 text-sm" id="c_harvest_list"></ul>
        </details>
      </div>
    </section>
  </main>

  <script>
    /* ---------------- i18n ---------------- */
    const dict = {
      en:{
        title:"Aquaculture A‚ÄìZ", subtitle:"Vendors & Culture", back_home:"Back",
        vendors:"Vendors", culture:"Prawn Culture",
        th_name:"Name", th_mobile:"Mobile",
        search_ph:"Search name or number‚Ä¶",
        // culture
        culture_title:"Prawn Culture ‚Äì Quick Guides",
        c_pond_title:"Pond Preparation (7‚Äì10 days)",
        c_pond_list:[
          "Dry pond bed; lime as per soil pH (6.5‚Äì8.5 target).",
          "Fill water 3‚Äì4 ft; chlorinate if needed; dechlorinate after 48 hrs.",
          "Probiotics pre-stock; check salinity, alkalinity, hardness."
        ],
        c_stock_title:"Stocking (Vannamei SPF PL)",
        c_stock_list:[
          "Acclimatize PL (temp/salinity) for 45‚Äì60 min.",
          "Density per practice (e.g., 40‚Äì60/m¬≤ intensive).",
          "Start feed @ 4‚Äì5% biomass; adjust by tray observations."
        ],
        c_water_title:"Daily Water Quality",
        c_water_list:[
          "DO > 5 mg/L (night aeration 8pm‚Äì3am if shallow).",
          "pH 7.5‚Äì8.2 (check morning/evening).",
          "Transparency 25‚Äì35 cm; stable golden/brown color."
        ],
        c_health_title:"Health & Disease",
        c_health_list:[
          "Vibriosis prevention: regular probiotics, avoid overfeeding.",
          "Lab checks weekly; histology if stress signs.",
          "Biosecurity: bird fencing, foot dips, sanitize gear."
        ],
        c_harvest_title:"Harvest & Post-Harvest",
        c_harvest_list:[
          "Plan ice & van logistics (use Harvest calculators).",
          "Clean ice; rapid chilling; avoid freshwater wash in saline species."
        ]
      },
      te:{
        title:"Aquaculture A‚ÄìZ", subtitle:"‡∞µ‡±Ü‡∞Ç‡∞°‡∞∞‡±ç‡∞≤‡±Å & ‡∞ï‡∞≤‡±ç‡∞ö‡∞∞‡±ç", back_home:"‡∞§‡∞ø‡∞∞‡±Å‡∞ó‡±Å",
        vendors:"‡∞µ‡±Ü‡∞Ç‡∞°‡∞∞‡±ç‡∞≤‡±Å", culture:"‡∞™‡±ç‡∞∞‡∞æ‡∞®‡±ç ‡∞ï‡∞≤‡±ç‡∞ö‡∞∞‡±ç",
        th_name:"‡∞™‡±á‡∞∞‡±Å", th_mobile:"‡∞Æ‡±ä‡∞¨‡±à‡∞≤‡±ç",
        search_ph:"‡∞™‡±á‡∞∞‡±Å ‡∞≤‡±á‡∞¶‡∞æ ‡∞®‡∞Ç‡∞¨‡∞∞‡±Å ‡∞∏‡±Ü‡∞∞‡±ç‡∞ö‡±ç‚Ä¶",
        culture_title:"‡∞™‡±ç‡∞∞‡∞æ‡∞®‡±ç ‡∞ï‡∞≤‡±ç‡∞ö‡∞∞‡±ç ‚Äì ‡∞ï‡±ç‡∞µ‡∞ø‡∞ï‡±ç ‡∞ó‡±à‡∞°‡±ç‡∞∏‡±ç",
        c_pond_title:"‡∞™‡∞æ‡∞Ç‡∞°‡±ç ‡∞™‡±ç‡∞∞‡∞ø‡∞™‡∞∞‡±á‡∞∑‡∞®‡±ç (7‚Äì10 ‡∞∞‡±ã‡∞ú‡±Å‡∞≤‡±Å)",
        c_pond_list:[
          "‡∞™‡∞æ‡∞Ç‡∞°‡±ç ‡∞¨‡±Ü‡∞°‡±ç ‡∞é‡∞Ç‡∞°‡∞¨‡±Ü‡∞ü‡±ç‡∞ü‡∞ø, ‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø pH ‡∞™‡±ç‡∞∞‡∞ï‡∞æ‡∞∞‡∞Ç ‡∞≤‡±à‡∞Æ‡±ç (‡∞≤‡∞ï‡±ç‡∞∑‡±ç‡∞Ø‡∞Ç 6.5‚Äì8.5).",
          "‡∞®‡±Ä‡∞≥‡±ç‡∞≤‡±Å 3‚Äì4 ‡∞Ö‡∞°‡±Å‡∞ó‡±Å‡∞≤‡±Å; ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Æ‡±à‡∞§‡±á ‡∞ï‡±ç‡∞≤‡±ã‡∞∞‡∞ø‡∞®‡±ç, 48‡∞ó‡∞Ç. ‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§ ‡∞°‡±Ä‡∞ï‡±ç‡∞≤‡±ã‡∞∞‡∞ø‡∞®‡±ç.",
          "‡∞∏‡±ç‡∞ü‡∞æ‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å ‡∞™‡±ç‡∞∞‡±ã‡∞¨‡∞Ø‡±ã‡∞ü‡∞ø‡∞ï‡±ç‡∞∏‡±ç; ‡∞∏‡∞æ‡∞≤‡∞ø‡∞®‡∞ø‡∞ü‡±Ä/‡∞Ü‡∞≤‡±ç‡∞ï‡∞≤‡∞ø‡∞®‡∞ø‡∞ü‡±Ä/‡∞π‡∞æ‡∞∞‡±ç‡∞°‡±ç‡∞®‡±Ü‡∞∏‡±ç ‡∞ö‡±Ü‡∞ï‡±ç."
        ],
        c_stock_title:"‡∞∏‡±ç‡∞ü‡∞æ‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç (‡∞µ‡∞®‡±ç‡∞®‡∞æ‡∞Æ‡±Ä SPF PL)",
        c_stock_list:[
          "PL ‡∞®‡±Å ‡∞ü‡±Ü‡∞Ç‡∞™‡±ç/‡∞∏‡∞æ‡∞≤‡∞ø‡∞®‡∞ø‡∞ü‡±Ä‡∞ï‡∞ø 45‚Äì60 ‡∞®‡∞ø‡∞Æ‡∞ø‡∞∑‡∞æ‡∞≤‡±Å ‡∞Ö‡∞≤‡∞µ‡∞æ‡∞ü‡±Å ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø.",
          "‡∞°‡±Ü‡∞®‡±ç‡∞∏‡∞ø‡∞ü‡±Ä ‡∞∏‡±ç‡∞•‡∞æ‡∞®‡∞ø‡∞ï ‡∞™‡∞¶‡±ç‡∞ß‡∞§‡∞ø ‡∞™‡±ç‡∞∞‡∞ï‡∞æ‡∞∞‡∞Ç (40‚Äì60/‡∞ö.‡∞Æ‡±Ä ‚Äì ‡∞á‡∞Ç‡∞ü‡±Ü‡∞®‡±ç‡∞∏‡∞ø‡∞µ‡±ç).",
          "‡∞´‡±Ä‡∞°‡±ç ‡∞¨‡∞Ø‡±ã‡∞Æ‡∞æ‡∞∏‡±ç 4‚Äì5% ‡∞§‡±ã ‡∞Æ‡±ä‡∞¶‡∞≤‡±Å; ‡∞ü‡±ç‡∞∞‡±á ‡∞Ö‡∞¨‡±ç‡∞ú‡∞∞‡±ç‡∞µ‡±á‡∞∑‡∞®‡±ç ‡∞¨‡∞ü‡±ç‡∞ü‡∞ø ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ö‡∞Ç‡∞°‡∞ø."
        ],
        c_water_title:"‡∞∞‡±ã‡∞ú‡±Å‡∞µ‡∞æ‡∞∞‡±Ä ‡∞®‡±Ä‡∞ü‡∞ø ‡∞ó‡±Å‡∞£‡∞æ‡∞≤‡±Å",
        c_water_list:[
          "DO > 5 mg/L (‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞≤‡±ã‡∞§‡±Å ponds ‡∞≤‡±ã ‡∞∞‡∞æ‡∞§‡±ç‡∞∞‡∞ø 8‚Äì3 ‡∞é‡∞∞‡±á‡∞∑‡∞®‡±ç).",
          "pH 7.5‚Äì8.2 (‡∞â‡∞¶‡∞Ø‡∞Ç/‡∞∏‡∞æ‡∞Ø‡∞Ç‡∞§‡±ç‡∞∞‡∞Ç ‡∞ö‡±Ü‡∞ï‡±ç).",
          "‡∞ü‡±ç‡∞∞‡∞æ‡∞®‡±ç‡∞∏‡±ç‚Äå‡∞™‡∞∞‡±Ü‡∞®‡±ç‡∞∏‡±Ä 25‚Äì35 ‡∞∏‡±Ü‡∞Ç.‡∞Æ‡±Ä; ‡∞ó‡±ã‡∞≤‡±ç‡∞°‡±Ü‡∞®‡±ç/‡∞¨‡±ç‡∞∞‡±å‡∞®‡±ç ‡∞ï‡∞≤‡∞∞‡±ç ‡∞∏‡±ç‡∞•‡∞ø‡∞∞‡∞Ç‡∞ó‡∞æ ‡∞â‡∞Ç‡∞°‡∞æ‡∞≤‡∞ø."
        ],
        c_health_title:"‡∞π‡±Ü‡∞≤‡±ç‡∞§‡±ç & ‡∞°‡∞ø‡∞∏‡±Ä‡∞ú‡±ç",
        c_health_list:[
          "‡∞µ‡∞ø‡∞¨‡±ç‡∞∞‡∞ø‡∞Ø‡±ã‡∞∏‡∞ø‡∞∏‡±ç ‡∞®‡∞ø‡∞µ‡∞æ‡∞∞‡∞£: ‡∞∞‡±Ü‡∞ó‡±ç‡∞Ø‡±Å‡∞≤‡∞∞‡±ç ‡∞™‡±ç‡∞∞‡±ã‡∞¨‡∞Ø‡±ã‡∞ü‡∞ø‡∞ï‡±ç‡∞∏‡±ç, ‡∞ì‡∞µ‡∞∞‡±ç‚Äå‡∞´‡±Ä‡∞°‡∞ø‡∞Ç‡∞ó‡±ç ‡∞µ‡∞¶‡±ç‡∞¶‡±Å.",
          "‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞µ‡∞æ‡∞∞‡∞Ç ‡∞≤‡±ç‡∞Ø‡∞æ‡∞¨‡±ç ‡∞ö‡±Ü‡∞ï‡±ç; ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡±Ü‡∞∏‡±ç ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡±à‡∞§‡±á ‡∞π‡∞ø‡∞∏‡±ç‡∞ü‡∞æ‡∞≤‡∞ú‡±Ä.",
          "‡∞¨‡∞Ø‡±ã‡∞∏‡±Ü‡∞ï‡±ç‡∞Ø‡±Ç‡∞∞‡∞ø‡∞ü‡±Ä: ‡∞™‡∞ï‡±ç‡∞∑‡∞ø ‡∞ú‡∞æ‡∞≤‡∞∞‡±ç‡∞≤‡±Å, ‡∞´‡±Å‡∞ü‡±ç ‡∞°‡∞ø‡∞™‡±ç‡∞∏‡±ç, ‡∞ó‡±á‡∞∞‡±ç ‡∞∂‡±Å‡∞≠‡±ç‡∞∞‡∞™‡∞∞‡∞ö‡∞°‡∞Ç."
        ],
        c_harvest_title:"‡∞π‡∞æ‡∞∞‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç & ‡∞™‡±ã‡∞∏‡±ç‡∞ü‡±ç-‡∞π‡∞æ‡∞∞‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç",
        c_harvest_list:[
          "‡∞ê‡∞∏‡±ç & ‡∞µ‡∞æ‡∞®‡±ç ‡∞≤‡∞æ‡∞ú‡∞ø‡∞∏‡±ç‡∞ü‡∞ø‡∞ï‡±ç‡∞∏‡±ç ‡∞Æ‡±Å‡∞Ç‡∞¶‡±Å‡∞ó‡∞æ‡∞®‡±á ‡∞™‡±ç‡∞≤‡∞æ‡∞®‡±ç (‡∞π‡∞æ‡∞∞‡±ç‡∞µ‡±Ü‡∞∏‡±ç‡∞ü‡±ç ‡∞ï‡±Ü‡∞≤‡±ç‡∞ï‡±Å‡∞≤‡±á‡∞ü‡∞∞‡±ç‡∞∏‡±ç ‡∞â‡∞™‡∞Ø‡±ã‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø).",
          "‡∞∂‡±Å‡∞≠‡±ç‡∞∞‡∞Æ‡±à‡∞® ‡∞ê‡∞∏‡±ç; ‡∞µ‡±á‡∞ó‡∞Ç‡∞ó‡∞æ ‡∞ö‡∞≤‡±ç‡∞≤‡∞¨‡∞∞‡∞ö‡∞°‡∞Ç; ‡∞∏‡∞æ‡∞≤‡±à‡∞®‡±ç ‡∞∏‡±ç‡∞™‡±Ä‡∞∏‡±Ä‡∞∏‡±ç‚Äå‡∞ï‡∞ø ‡∞´‡±ç‡∞∞‡±Ü‡∞∑‡±ç ‡∞µ‡∞æ‡∞ü‡∞∞‡±ç ‡∞µ‡∞æ‡∞∑‡±ç ‡∞µ‡∞¶‡±ç‡∞¶‡±Å."
        ]
      }
    };

    function setLangTexts(){
      const lang = localStorage.getItem('lang') || 'te';
      const L = dict[lang];
      document.documentElement.lang = lang;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const k = el.getAttribute('data-i18n');
        el.textContent = L[k] ?? '';
      });
      const ph = document.querySelector('[data-i18n-placeholder="search_ph"]');
      if (ph) ph.placeholder = L.search_ph;

      // culture lists fill
      const fill = (id, arr)=>{ const ul=document.getElementById(id); if(!ul) return; ul.innerHTML = (arr||[]).map(x=>`<li>${x}</li>`).join(''); };
      fill('c_pond_list',L.c_pond_list); fill('c_stock_list',L.c_stock_list);
      fill('c_water_list',L.c_water_list); fill('c_health_list',L.c_health_list);
      fill('c_harvest_list',L.c_harvest_list);
    }

    // Theme
    const themeToggle = document.getElementById('themeToggle');
    const savedTheme = localStorage.getItem('theme');
    if(savedTheme==='dark'||(!savedTheme&&matchMedia('(prefers-color-scheme: dark)').matches)){
      document.documentElement.classList.add('dark');
    }
    themeToggle.addEventListener('click',()=>{
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark')?'dark':'light');
    });

    // Toggle Views
    const btnVendors = document.getElementById('btnVendors');
    const btnCulture = document.getElementById('btnCulture');
    const secVendors = document.getElementById('v-vendors');
    const secCulture = document.getElementById('v-culture');
    const vendorFilters = document.getElementById('vendorFilters');
    function showVendors(){
      btnVendors.classList.add('bg-emerald-600','text-white');
      btnCulture.classList.remove('bg-emerald-600','text-white');
      btnCulture.classList.add('bg-white','dark:bg-slate-900');
      secVendors.classList.remove('hidden'); secCulture.classList.add('hidden');
      vendorFilters.classList.remove('hidden');
    }
    function showCulture(){
      btnCulture.classList.add('bg-emerald-600','text-white');
      btnVendors.classList.remove('bg-emerald-600','text-white');
      btnVendors.classList.add('bg-white','dark:bg-slate-900');
      secCulture.classList.remove('hidden'); secVendors.classList.add('hidden');
      vendorFilters.classList.add('hidden');
    }
    btnVendors.addEventListener('click',showVendors);
    btnCulture.addEventListener('click',showCulture);

    // Vendors data + filters
    const fCategory = document.getElementById('fCategory');
    const fDistrict = document.getElementById('fDistrict');
    const fSearch   = document.getElementById('fSearch');
    const tbody     = document.querySelector('#dealersTable tbody');

    const demoRows = [
      {name:'Sri Venkateswara Feeds',cat:'Feeds',district:'Nellore',phone:'+91 98765 43210',wa:'+919876543210'},
      {name:'Blue Aqua Hatchery',cat:'Seeds',district:'Nellore',phone:'+91 91234 56780',wa:'+919123456780'},
      {name:'Godavari Aqua Care',cat:'Medicines',district:'East Godavari',phone:'+91 90000 11122',wa:'+919000011122'},
      {name:'Krishna Aqua Mart',cat:'Supplies',district:'Krishna',phone:'+91 90123 45678',wa:'+919012345678'}
    ];
    let rows = [];

    async function loadDealers(){
      try{
        const res = await fetch('./dealers.csv',{cache:'no-store'});
        if(!res.ok) throw new Error('no csv');
        const text = await res.text();
        const lines = text.trim().split(/\r?\n/);
        const h = lines[0].split(',').map(s=>s.trim().toLowerCase());
        const iN=h.indexOf('name'), iC=h.indexOf('category'), iD=h.indexOf('district'), iP=h.indexOf('phone'), iW=h.indexOf('whatsapp');
        rows = lines.slice(1).map(r=>{ const c=r.split(','); return {name:c[iN],cat:c[iC],district:c[iD],phone:c[iP],wa:c[iW]}; })
                      .filter(r=>r && r.name);
      }catch(e){ rows = demoRows; }
      buildFilters(); draw();
    }

    function uniqSorted(arr){ return Array.from(new Set(arr.filter(Boolean))).sort((a,b)=>a.localeCompare(b)); }
    function buildFilters(){
      const cats = uniqSorted(rows.map(r=>r.cat));
      const dists = uniqSorted(rows.map(r=>r.district));
      fCategory.innerHTML = `<option value="">${dict[localStorage.getItem('lang')||'te'].vendors || 'Vendors'} ‚Äì All</option>` + cats.map(c=>`<option>${c}</option>`).join('');
      fDistrict.innerHTML = `<option value="">All</option>` + dists.map(d=>`<option>${d}</option>`).join('');
    }

    function normDigits(s){ return (s||'').replace(/[^\d]/g,''); }
    function draw(){
      const cat = fCategory.value||'';
      const dist= fDistrict.value||'';
      const term= (fSearch.value||'').toLowerCase();
      const digits = normDigits(term);

      const filtered = rows.filter(r=>{
        if(cat && r.cat!==cat) return false;
        if(dist && r.district!==dist) return false;
        if(!term) return true;
        return r.name.toLowerCase().includes(term) || (!!digits && normDigits(r.phone).includes(digits));
      });

      tbody.innerHTML = '';
      filtered.forEach(d=>{
        const tr=document.createElement('tr'); tr.className='border-b last:border-0 dark:border-slate-800';
        const phone=(d.phone||'').trim();
        tr.innerHTML = `
          <td class="py-2 pr-4">${d.name}</td>
          <td class="py-2 pr-0"><a class="underline" href="tel:${phone}">${phone}</a></td>`;
        tbody.appendChild(tr);
      });
    }

    [fCategory,fDistrict].forEach(el=>el.addEventListener('change',draw));
    fSearch.addEventListener('input',draw);

    // Lang buttons
    document.getElementById('langEN').addEventListener('click',()=>{localStorage.setItem('lang','en'); setLangTexts(); buildFilters(); draw();});
    document.getElementById('langTE').addEventListener('click',()=>{localStorage.setItem('lang','te'); setLangTexts(); buildFilters(); draw();});

    // INIT
    (function init(){
      if(!localStorage.getItem('lang')) localStorage.setItem('lang','te');
      setLangTexts(); showVendors(); loadDealers();
    })();
  </script>
</body>
</html>
