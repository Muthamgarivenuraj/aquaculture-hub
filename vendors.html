<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Vendors • Aquaculture A–Z</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class'}
  </script>
  <style>
    .promo-dot{height:.5rem;width:.5rem;border-radius:9999px;border:1px solid currentColor;opacity:.5}
    .promo-dot.active{opacity:1;background:currentColor}
    .promo-slide{display:none}
    .promo-slide.active{display:block}

    .weather-card{
      border-radius:1rem;
      padding:1.5rem;
      color:white;
      background:linear-gradient(135deg,#60a5fa 0%,#2563eb 100%);
      box-shadow:0 8px 20px rgba(0,0,0,.2);
      text-align:center;
    }
    .dark .weather-card{
      background:linear-gradient(135deg,#1e293b 0%,#0f172a 100%);
    }
    .weather-temp{
      font-size:2.5rem;
      font-weight:700;
    }
    .weather-desc{
      font-size:1.2rem;
      margin-top:.25rem;
    }
    .weather-extra{
      margin-top:.8rem;
      font-size:.9rem;
      display:flex;
      justify-content:space-around;
    }
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100 bg-gradient-to-br from-blue-100 via-blue-50 to-green-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900">
  <!-- Header -->
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <a href="index.html" class="rounded-lg px-3 py-1.5 border border-slate-200 dark:border-slate-800">←</a>
        <h1 class="text-lg font-bold" data-i18n="vendors_title">వెండర్లు</h1>
      </div>
      <!-- Desktop buttons -->
      <div class="hidden sm:flex gap-3 ml-6">
        <button class="px-3 py-1.5 rounded-lg bg-blue-100 dark:bg-blue-900" data-i18n="feed">🌿 Feed</button>
        <button class="px-3 py-1.5 rounded-lg bg-pink-100 dark:bg-pink-900" data-i18n="medicine">💊 Medicine</button>
        <button class="px-3 py-1.5 rounded-lg bg-green-100 dark:bg-green-900" data-i18n="technicians">👨‍🔧 Technicians</button>
      </div>
      <!-- Language & Theme -->
      <div class="flex items-center gap-2">
        <select id="langSel" class="text-sm border rounded-md px-2 py-1 dark:bg-slate-900 dark:border-slate-700">
          <option value="te">తెలుగు</option>
          <option value="en">English</option>
        </select>
        <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border border-slate-200 dark:border-slate-800">🌙/☀️</button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4 space-y-6">
    <!-- Mobile buttons -->
    <div class="flex sm:hidden gap-3 justify-around">
      <button class="flex-1 px-3 py-2 rounded-lg bg-blue-100 dark:bg-blue-900" data-i18n="feed">🌿 Feed</button>
      <button class="flex-1 px-3 py-2 rounded-lg bg-pink-100 dark:bg-pink-900" data-i18n="medicine">💊 Medicine</button>
      <button class="flex-1 px-3 py-2 rounded-lg bg-green-100 dark:bg-green-900" data-i18n="technicians">👨‍🔧 Tech</button>
    </div>

    <!-- Promotions -->
    <section class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow border">
      <h2 class="font-semibold mb-2">📢 <span data-i18n="promotions">Promotions</span></h2>
      <div id="promoSlider" class="relative">
        <div id="promoTrack"></div>
        <div id="promoDots" class="mt-2 flex gap-2"></div>
      </div>
    </section>

    <!-- Weather -->
    <section class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow border">
      <h2 class="font-semibold mb-2">🌦️ <span data-i18n="weather">వాతావరణ సూచన</span></h2>
      <div id="weatherBox">Loading...</div>
    </section>
  </main>

  <script>
    const API_KEY="dd76809d5e71a15ca87c39247f74c349"; // ✅ Your Key

    const dict={
      en:{vendors_title:"Vendors",feed:"Feed",medicine:"Medicine",technicians:"Technicians",promotions:"Promotions",weather:"Weather"},
      te:{vendors_title:"వెండర్లు",feed:"ఫీడ్",medicine:"మందులు",technicians:"టెక్నీషియన్లు",promotions:"ప్రోమోషన్స్",weather:"వాతావరణ సూచన"}
    };

    function applyI18n(){
      const lang=localStorage.getItem('lang')||'te';
      document.documentElement.lang=lang;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key=el.dataset.i18n;
        if(dict[lang][key]) el.textContent=dict[lang][key];
      });
      document.getElementById("langSel").value=lang;
    }

    async function loadWeather(){
      try{
        const res=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Nellore,IN&appid=${API_KEY}&units=metric`);
        if(!res.ok) throw new Error("API error");
        const d=await res.json();
        const icon=`https://openweathermap.org/img/wn/${d.weather[0].icon}@2x.png`;
        const hour=new Date().getHours();
        let bg=hour>=6 && hour<18 ? "linear-gradient(135deg,#60a5fa 0%,#2563eb 100%)" : "linear-gradient(135deg,#0f172a 0%,#1e293b 100%)";

        document.getElementById("weatherBox").innerHTML=`
          <div class="weather-card" style="background:${bg}">
            <div><img src="${icon}" class="mx-auto w-20 h-20"></div>
            <div class="weather-temp">${Math.round(d.main.temp)}°C</div>
            <div class="weather-desc">${d.weather[0].description}</div>
            <div class="weather-extra">
              <div>🌡️ Min: ${Math.round(d.main.temp_min)}°C</div>
              <div>🌡️ Max: ${Math.round(d.main.temp_max)}°C</div>
            </div>
            <div class="weather-extra">
              <div>💧 ${d.main.humidity}%</div>
              <div>💨 ${d.wind.speed} m/s</div>
            </div>
          </div>`;
      }catch(e){
        document.getElementById("weatherBox").innerHTML=`<span class="text-amber-600">⚠️ Weather unavailable</span>`;
      }
    }

    // Promotions dummy
    const PROMOS=[
      {title_en:"Buy 1 Get 1 Free",title_te:"1 కొంటే 1 ఉచితం",desc_en:"This week only!",desc_te:"ఈ వారం ప్రత్యేక ఆఫర్."},
      {title_en:"20% Off Medicines",title_te:"20% డిస్కౌంట్ మందులు",desc_en:"On all shrimp medicines",desc_te:"అన్ని రొయ్యల మందులపై."}
    ];
    let promoIdx=0,timer=null;
    function renderPromo(){
      const lang=localStorage.getItem('lang')||'te';
      const track=document.getElementById("promoTrack"),dots=document.getElementById("promoDots");
      track.innerHTML=PROMOS.map((r,i)=>`
        <div class="promo-slide ${i===promoIdx?'active':''}">
          <div class="p-3 rounded-xl bg-blue-50 dark:bg-slate-800">${lang==='te'?r.title_te:r.title_en}
            <p class="text-sm">${lang==='te'?r.desc_te:r.desc_en}</p>
          </div>
        </div>`).join('');
      dots.innerHTML=PROMOS.map((_,i)=>`<button class="promo-dot ${i===promoIdx?'active':''}" data-i="${i}"></button>`).join('');
      dots.querySelectorAll('button').forEach(b=>b.onclick=()=>{promoIdx=+b.dataset.i;renderPromo();startPromo();});
    }
    function startPromo(){if(timer)clearInterval(timer);timer=setInterval(()=>{promoIdx=(promoIdx+1)%PROMOS.length;renderPromo();},5000);}

    document.addEventListener("DOMContentLoaded",()=>{
      if(!localStorage.getItem("lang")) localStorage.setItem("lang","te");
      applyI18n();

      const saved=localStorage.getItem("theme");
      if(saved==="dark"||(!saved&&matchMedia('(prefers-color-scheme: dark)').matches))document.documentElement.classList.add("dark");
      document.getElementById("themeToggle").onclick=()=>{document.documentElement.classList.toggle("dark");localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light");};
      document.getElementById("langSel").onchange=e=>{localStorage.setItem("lang",e.target.value);applyI18n();renderPromo();};

      renderPromo();startPromo();loadWeather();
    });
  </script>
</body>
</html>
