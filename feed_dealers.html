<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Feed Booking ‚Ä¢ Aquaculture A‚ÄìZ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class'};
  </script>
  <style>
    body{background:linear-gradient(135deg,#dbeafe 0,#f0fdf4 100%)}
    .dark body{background:linear-gradient(135deg,#0f172a 0,#14532d 100%)}
    .field{border:1px solid #cbd5e1;border-radius:.5rem;padding:.5rem}
    .btn{padding:.6rem 1rem;border-radius:.75rem}
    .btn-primary{background:#059669;color:white}
    .btn[disabled]{opacity:.5;cursor:not-allowed}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100">
  <!-- Header -->
  <header class="sticky top-0 z-30 bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-700 p-3 flex justify-between">
    <h1 class="text-lg font-bold" data-i18n="feed_booking">Feed Booking</h1>
    <div class="flex gap-2">
      <select id="langSel" class="border rounded px-2 py-1 dark:bg-slate-900 dark:border-slate-700">
        <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
        <option value="en">English</option>
      </select>
      <button id="themeToggle" class="border rounded px-2">üåô/‚òÄÔ∏è</button>
    </div>
  </header>

  <main class="max-w-4xl mx-auto p-4 space-y-4">
    <!-- Form -->
    <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow border space-y-3">
      <label><span data-i18n="feed_company">Feed Company</span>
        <select id="feedCompany" class="field w-full">
          <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
          <option>Avanthi</option>
          <option>CP</option>
          <option>My Test Dealer - 9963643062</option>
        </select>
      </label>

      <div>
        <span data-i18n="pay_mode">Payment Mode</span><br/>
        <label><input type="radio" name="payMode" value="spot" checked> <span data-i18n="spot_cash">Spot Cash</span></label>
        <label class="ml-4"><input type="radio" name="payMode" value="credit"> <span data-i18n="credit">Credit (Appu)</span></label>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <label><span data-i18n="qty_type">Quantity Type</span>
          <select id="qtyType" class="field w-full">
            <option value="">Select / ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø</option>
            <option value="Bags">Bags / ‡∞¨‡∞æ‡∞ó‡±ç‡∞∏‡±ç</option>
            <option value="Tons">Tons / ‡∞ü‡∞®‡±ç‡∞®‡±Å‡∞≤‡±Å</option>
          </select>
        </label>
        <label><span data-i18n="qty">Quantity</span>
          <input id="qty" type="number" class="field w-full" value="0">
        </label>
        <label><span data-i18n="feed_cost">Feed Cost</span>
          <input id="feedCost" readonly class="field w-full">
        </label>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
        <label><span data-i18n="transport_type">Transport Type</span>
          <select id="tType" class="field w-full">
            <option value="auto">Auto Van (‚Çπ80/km)</option>
            <option value="big">Big Van (‚Çπ150/km)</option>
          </select>
        </label>
        <label><span data-i18n="distance">Distance (km)</span>
          <input id="distance" type="number" class="field w-full" value="0">
        </label>
        <label><span data-i18n="t_cost">Transport Cost</span>
          <input id="tCost" readonly class="field w-full">
        </label>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label><span data-i18n="cust_mobile">Customer Mobile *</span>
          <input id="custMobile" type="tel" maxlength="10" class="field w-full" placeholder="9xxxxxxxxx">
        </label>
        <label><span data-i18n="address">Address *</span>
          <div class="flex gap-2">
            <input id="custAddress" class="field w-full" placeholder="Village, Mandal, District">
            <button id="locBtn" class="btn border">üìç</button>
          </div>
        </label>
      </div>

      <div class="p-3 rounded-xl bg-emerald-50 dark:bg-emerald-900/30 flex justify-between">
        <div>üßÆ <span data-i18n="grand_total">Grand Total</span>: <b id="grandTotal">‚Çπ 0</b></div>
        <button id="finalBook" class="btn btn-primary" disabled data-i18n="final_book">Finalize Booking</button>
      </div>
    </div>
  </main>

  <script>
    const dict={
      en:{feed_booking:"Feed Booking",feed_company:"Feed Company",pay_mode:"Payment Mode",spot_cash:"Spot Cash",credit:"Credit (Appu)",qty_type:"Quantity Type",qty:"Quantity",feed_cost:"Feed Cost",transport_type:"Transport Type",distance:"Distance (km)",t_cost:"Transport Cost",cust_mobile:"Customer Mobile",address:"Address",grand_total:"Grand Total",final_book:"Finalize Booking"},
      te:{feed_booking:"‡∞´‡±Ä‡∞°‡±ç ‡∞¨‡±Å‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç",feed_company:"‡∞´‡±Ä‡∞°‡±ç ‡∞ï‡∞Ç‡∞™‡±Ü‡∞®‡±Ä",pay_mode:"‡∞ö‡±Ü‡∞≤‡±ç‡∞≤‡∞ø‡∞Ç‡∞™‡±Å ‡∞∞‡∞ï‡∞Ç",spot_cash:"‡∞∏‡±ç‡∞™‡∞æ‡∞ü‡±ç ‡∞ï‡±ç‡∞Ø‡∞æ‡∞∑‡±ç",credit:"‡∞Ö‡∞™‡±ç‡∞™‡±Å",qty_type:"‡∞Æ‡±ã‡∞§‡∞æ‡∞¶‡±Å‡∞≤ ‡∞∞‡∞ï‡∞Ç",qty:"‡∞Æ‡±ä‡∞§‡±ç‡∞§‡∞Ç",feed_cost:"‡∞´‡±Ä‡∞°‡±ç ‡∞ñ‡∞∞‡±ç‡∞ö‡±Å",transport_type:"‡∞∞‡∞µ‡∞æ‡∞£‡∞æ ‡∞∞‡∞ï‡∞Ç",distance:"‡∞¶‡±Ç‡∞∞‡∞Ç (km)",t_cost:"‡∞∞‡∞µ‡∞æ‡∞£‡∞æ ‡∞ñ‡∞∞‡±ç‡∞ö‡±Å",cust_mobile:"‡∞ï‡∞∏‡±ç‡∞ü‡∞Æ‡∞∞‡±ç ‡∞Æ‡±ä‡∞¨‡±à‡∞≤‡±ç",address:"‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞æ‡∞Æ‡∞æ",grand_total:"‡∞ó‡±ç‡∞∞‡∞æ‡∞Ç‡∞°‡±ç ‡∞ü‡±ã‡∞ü‡∞≤‡±ç",final_book:"‡∞´‡±à‡∞®‡∞≤‡±ç ‡∞¨‡±Å‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç"}
    };
    function applyI18n(){const lang=localStorage.getItem("lang")||"te";document.querySelectorAll("[data-i18n]").forEach(el=>{const k=el.dataset.i18n;if(dict[lang][k])el.textContent=dict[lang][k];});document.getElementById("langSel").value=lang;}

    // Feed price rules
    const feedRates={spot:{bag:2100,ton:84000},credit:{bag:2250,ton:90000}};

    function updateCosts(){
      const mode=document.querySelector("input[name='payMode']:checked")?.value||"spot";
      const qType=document.getElementById("qtyType").value;
      const qty=parseFloat(document.getElementById("qty").value)||0;
      const dist=parseFloat(document.getElementById("distance").value)||0;
      const tType=document.getElementById("tType").value;

      // feed cost
      let feedCost=0;
      if(qType==="Bags") feedCost=qty*feedRates[mode].bag;
      if(qType==="Tons") feedCost=qty*feedRates[mode].ton;

      // transport
      let rate=(tType==="auto"?80:150);
      let tCost=dist*rate;

      // update UI
      document.getElementById("feedCost").value="‚Çπ "+feedCost.toLocaleString();
      document.getElementById("tCost").value="‚Çπ "+tCost.toLocaleString();
      document.getElementById("grandTotal").textContent="‚Çπ "+(feedCost+tCost).toLocaleString();

      // enable booking only if qty>0 and mobile valid
      const ok=/^[6-9]\d{9}$/.test(document.getElementById("custMobile").value||"");
      document.getElementById("finalBook").disabled=!(qty>0&&ok);
    }

    ["qtyType","qty","distance","tType"].forEach(id=>{
      document.getElementById(id).addEventListener("change",updateCosts);
      document.getElementById(id).addEventListener("input",updateCosts);
    });
    document.querySelectorAll("input[name='payMode']").forEach(r=>r.addEventListener("change",updateCosts));
    document.getElementById("custMobile").addEventListener("input",updateCosts);

    // üìç location
    document.getElementById("locBtn").addEventListener("click",e=>{
      e.preventDefault();
      navigator.geolocation?.getCurrentPosition(pos=>{
        document.getElementById("custAddress").value=`Lat:${pos.coords.latitude.toFixed(4)}, Lng:${pos.coords.longitude.toFixed(4)}`;
      });
    });

    document.addEventListener("DOMContentLoaded",()=>{
      if(localStorage.getItem("theme")==="dark")document.documentElement.classList.add("dark");
      document.getElementById("themeToggle").onclick=()=>{document.documentElement.classList.toggle("dark");localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light");};
      if(!localStorage.getItem("lang"))localStorage.setItem("lang","te");applyI18n();
      document.getElementById("langSel").onchange=e=>{localStorage.setItem("lang",e.target.value);applyI18n();};
    });
  </script>
</body>
</html>
