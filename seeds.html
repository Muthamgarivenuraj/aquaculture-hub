<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Seeds ‚Ä¢ Aquaculture A‚ÄìZ</title>

  <!-- üåô Early theme boot -->
  <script>
    (function(){
      try{
        const t=localStorage.getItem('theme');
        if(t==='dark'||(!t && matchMedia('(prefers-color-scheme: dark)').matches)){
          document.documentElement.classList.add('dark');
        }
      }catch(e){}
    })();
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config={darkMode:'class',theme:{extend:{boxShadow:{soft:'0 12px 28px rgba(2,6,23,.08)'}}}}
  </script>
  <style>
    html{scroll-behavior:smooth}
    body{background:linear-gradient(135deg,#dbeafe 0%,#e0f2fe 50%,#f0fdf4 100%)}
    .dark body{background:linear-gradient(135deg,#0f172a 0%,#082f49 50%,#14532d 100%)}
    .field{border:1px solid rgb(226,232,240);border-radius:.5rem;padding:.5rem .6rem}
    .dark .field{background:#0b1220;border-color:#334155;color:#e2e8f0}
    .btn{padding:.6rem 1rem;border-radius:.75rem}
    .btn-primary{background:#059669;color:#fff}
    .btn-primary[disabled]{opacity:.5;cursor:not-allowed}
    .badge{font-size:.75rem;padding:.2rem .55rem;border-radius:.5rem}
  </style>
</head>
<body class="text-slate-900 dark:text-slate-100">
  <header class="sticky top-0 z-30 backdrop-blur bg-white/80 dark:bg-slate-950/70 border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center gap-3">
      <a href="index.html" class="rounded-lg px-3 py-1.5 border border-slate-200 dark:border-slate-800">‚Üê</a>
      <h1 class="text-lg font-bold flex-1" data-i18n="seed_title">Seed Booking</h1>
      <div class="hidden sm:flex rounded-full bg-slate-100 dark:bg-slate-900 p-1 border border-slate-200 dark:border-slate-800">
        <button id="langTE" class="px-3 py-1.5 text-sm rounded-full bg-white dark:bg-slate-800">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
        <button id="langEN" class="px-3 py-1.5 text-sm rounded-full">English</button>
      </div>
      <button id="themeToggle" class="rounded-full px-3 py-1.5 text-sm border border-slate-200 dark:border-slate-800">üåô/‚òÄÔ∏è</button>
    </div>
  </header>

  <main class="max-w-5xl mx-auto p-4">
    <div class="rounded-2xl p-4 bg-white dark:bg-slate-900 shadow-soft border border-slate-200/60 dark:border-slate-800 space-y-5">

      <!-- Selectors -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
        <label class="text-sm">
          <span data-i18n="state">State</span>
          <select id="sState" class="mt-1 field w-full">
            <option>Andhra Pradesh</option>
            <option>Tamil Nadu</option>
          </select>
        </label>

        <label class="text-sm">
          <span data-i18n="district">District</span>
          <select id="sDistrict" class="mt-1 field w-full"></select>
        </label>

        <label class="text-sm md:col-span-2">
          <span data-i18n="hatchery">Hatchery</span>
          <div class="mt-1 flex gap-2">
            <select id="sHatchery" class="field flex-1">
              <!-- filled by JS -->
            </select>
            <!-- read-only Bonus badge -->
            <span id="sBonusBadge" class="badge bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-200 whitespace-nowrap">Bonus ‚Äî 0%</span>
          </div>
        </label>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
        <label class="text-sm">
          <span data-i18n="price_per">Price/1000 (‚Çπ)</span>
          <input id="sPrice" type="number" class="mt-1 field w-full" readonly>
        </label>

        <label class="text-sm">
          <span data-i18n="production">Production</span>
          <select id="sBatch" class="mt-1 field w-full">
            <option>Batch 1</option><option>Batch 2</option>
          </select>
        </label>

        <label class="text-sm">
          <span data-i18n="booking_date">Booking Date</span>
          <input id="sDate" type="date" class="mt-1 field w-full">
        </label>

        <label class="text-sm">
          <span data-i18n="qty_pcs">Quantity (pcs)</span>
          <input id="sQty" type="number" value="0" class="mt-1 field w-full">
        </label>
      </div>

      <!-- Totals -->
      <p class="text-sm">
        <span data-i18n="bonus_percent">Bonus %</span>:
        <b id="sBonusPct">0%</b> |
        <span data-i18n="total_seeds">Total Seeds</span>:
        <b id="sTotalSeeds">0</b> |
        <span data-i18n="amount">Amount</span>:
        <b id="sAmount">‚Çπ 0</b>
      </p>

      <!-- Customer (OTP + Address) -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <label class="text-sm">
          <span data-i18n="cust_mobile">Customer Mobile *</span>
          <div class="mt-1 flex gap-2">
            <input id="custMobile" type="tel" placeholder="9xxxxxxxxx" class="field w-full" maxlength="10" inputmode="numeric" pattern="[6-9][0-9]{9}">
            <button id="sendOtp" class="btn btn-primary whitespace-nowrap" type="button" data-i18n="send_otp">Send OTP</button>
          </div>
          <div id="otpHint" class="mt-1 text-xs text-slate-500"></div>
        </label>

        <label class="text-sm">
          <span data-i18n="enter_otp">Enter OTP</span>
          <div class="mt-1 flex gap-2">
            <input id="otpInput" type="number" class="field w-full" placeholder="******" maxlength="6">
            <button id="verifyOtp" class="btn border border-emerald-600 text-emerald-700" type="button" data-i18n="verify">Verify</button>
          </div>
          <div id="otpStatus" class="mt-1 text-xs"></div>
        </label>

        <label class="text-sm">
          <span data-i18n="address">Address *</span>
          <input id="custAddress" class="mt-1 field w-full" placeholder="Village, Mandal, District">
        </label>
      </div>

      <!-- Action -->
      <div class="p-3 rounded-xl bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div class="text-sm font-medium">üßÆ <span data-i18n="grand_total">Grand Total</span>:
          <b id="sGrand">‚Çπ 0</b>
        </div>
        <button id="sBook" class="btn btn-primary md:self-end" disabled data-i18n="final_book">Finalize Booking</button>
      </div>

      <p class="text-xs text-slate-500"><span class="badge bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-200">Note</span>
        <span data-i18n="note_text">Booking requires verified mobile & address.</span>
      </p>
    </div>
  </main>

  <script>
    // ---------- i18n ----------
    const dict={
      en:{seed_title:"Seed Booking",state:"State",district:"District",hatchery:"Hatchery",price_per:"Price/1000 (‚Çπ)",production:"Production",booking_date:"Booking Date",qty_pcs:"Quantity (pcs)",bonus_percent:"Bonus %",total_seeds:"Total Seeds",amount:"Amount",cust_mobile:"Customer Mobile",send_otp:"Send OTP",enter_otp:"Enter OTP",verify:"Verify",address:"Address",grand_total:"Grand Total",final_book:"Finalize Booking",note_text:"Booking requires verified mobile & address.",otp_sent:"OTP sent (demo): ",otp_invalid:"Invalid number. Enter 10 digits starting with 6‚Äì9.",otp_ok:"Verified ‚úì",otp_wrong:"Wrong OTP"},
      te:{seed_title:"‡∞∏‡±Ä‡∞°‡±ç‡∞∏‡±ç ‡∞¨‡±Å‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç",state:"‡∞∞‡∞æ‡∞∑‡±ç‡∞ü‡±ç‡∞∞‡∞Ç",district:"‡∞ú‡∞ø‡∞≤‡±ç‡∞≤‡∞æ",hatchery:"‡∞π‡±ç‡∞Ø‡∞æ‡∞ö‡∞∞‡±Ä",price_per:"‡∞ß‡∞∞/1000 (‚Çπ)",production:"‡∞™‡±ç‡∞∞‡±ä‡∞°‡∞ï‡±ç‡∞∑‡∞®‡±ç",booking_date:"‡∞¨‡±Å‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç ‡∞§‡±á‡∞¶‡±Ä",qty_pcs:"‡∞™‡∞∞‡∞ø‡∞Æ‡∞æ‡∞£‡∞Ç (‡∞™‡±Ä‡∞∏‡±Å‡∞≤‡±Å)",bonus_percent:"‡∞¨‡±ã‡∞®‡∞∏‡±ç %",total_seeds:"‡∞Æ‡±ä‡∞§‡±ç‡∞§‡∞Ç ‡∞∏‡±Ä‡∞°‡±ç‡∞∏‡±ç",amount:"‡∞Ö‡∞Æ‡±å‡∞Ç‡∞ü‡±ç",cust_mobile:"‡∞ï‡∞∏‡±ç‡∞ü‡∞Æ‡∞∞‡±ç ‡∞Æ‡±ä‡∞¨‡±à‡∞≤‡±ç",send_otp:"OTP ‡∞™‡∞Ç‡∞™‡±Å",enter_otp:"OTP ‡∞é‡∞Ç‡∞ü‡∞∞‡±ç ‡∞ö‡±á‡∞Ø‡∞ø",verify:"‡∞µ‡±Ü‡∞∞‡∞ø‡∞´‡±à",address:"‡∞Ö‡∞°‡±ç‡∞∞‡∞∏‡±ç",grand_total:"‡∞ó‡±ç‡∞∞‡∞æ‡∞Ç‡∞°‡±ç ‡∞ü‡±ã‡∞ü‡∞≤‡±ç",final_book:"‡∞´‡±à‡∞®‡∞≤‡±ç ‡∞¨‡±Å‡∞ï‡±ç",note_text:"‡∞¨‡±Å‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç‚Äå‡∞ï‡∞ø ‡∞µ‡±Ü‡∞∞‡∞ø‡∞´‡±à ‡∞Ö‡∞Ø‡∞ø‡∞® ‡∞Æ‡±ä‡∞¨‡±à‡∞≤‡±ç & ‡∞Ö‡∞°‡±ç‡∞∞‡∞∏‡±ç ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç.",otp_sent:"OTP ‡∞™‡∞Ç‡∞™‡∞¨‡∞°‡∞ø‡∞Ç‡∞¶‡∞ø (‡∞°‡±Ü‡∞Æ‡±ã): ",otp_invalid:"‡∞∏‡∞∞‡±à‡∞® 10 ‡∞Ö‡∞Ç‡∞ï‡±Ü‡∞≤ ‡∞Æ‡±ä‡∞¨‡±à‡∞≤‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç ‡∞á‡∞µ‡±ç‡∞µ‡∞Ç‡∞°‡∞ø (6‚Äì9 ‡∞§‡±ã ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞Ç).",otp_ok:"‡∞µ‡±Ü‡∞∞‡∞ø‡∞´‡±à ‡∞Ö‡∞Ø‡∞ø‡∞Ç‡∞¶‡∞ø ‚úì",otp_wrong:"‡∞§‡∞™‡±ç‡∞™‡±Å OTP"}
    };
    function setLang(){const l=localStorage.getItem('lang')||'te';document.documentElement.lang=l;document.querySelectorAll('[data-i18n]').forEach(el=>{const k=el.dataset.i18n;if(dict[l][k]) el.textContent=dict[l][k];});}
    themeToggle.onclick=()=>{document.documentElement.classList.toggle('dark');localStorage.setItem('theme',document.documentElement.classList.contains('dark')?'dark':'light');};
    langEN.onclick=()=>{localStorage.setItem('lang','en');setLang();updateTotals();}
    langTE.onclick=()=>{localStorage.setItem('lang','te');setLang();updateTotals();}

    // ---------- Data (with static bonus %) ----------
    // price = ‚Çπ per 1000 PL, bonusPct = static bonus shown next to hatchery (read-only)
    let seedsData=[
      {state:'Andhra Pradesh',district:'Nellore',hatchery:'Blue Aqua',price:350,bonusPct:20},
      {state:'Andhra Pradesh',district:'Krishna',hatchery:'Delta Hatchery',price:370,bonusPct:30},
      {state:'Tamil Nadu',district:'',hatchery:'Chennai Aqua',price:360,bonusPct:25}
    ];

    // ---------- Elements ----------
    const sState=document.getElementById('sState'),
          sDistrict=document.getElementById('sDistrict'),
          sHatch=document.getElementById('sHatchery'),
          sBonusBadge=document.getElementById('sBonusBadge'),
          sPrice=document.getElementById('sPrice'),
          sBatch=document.getElementById('sBatch'),
          sDate=document.getElementById('sDate'),
          sQty=document.getElementById('sQty'),
          sBonusPct=document.getElementById('sBonusPct'),
          sTotalSeeds=document.getElementById('sTotalSeeds'),
          sAmount=document.getElementById('sAmount'),
          sGrand=document.getElementById('sGrand'),
          sBook=document.getElementById('sBook');

    // OTP & Address
    const mobile=document.getElementById('custMobile'),
          sendOtp=document.getElementById('sendOtp'),
          otpInput=document.getElementById('otpInput'),
          verifyOtp=document.getElementById('verifyOtp'),
          otpHint=document.getElementById('otpHint'),
          otpStatus=document.getElementById('otpStatus'),
          address=document.getElementById('custAddress');

    function fillDistrict(){
      const st=sState.value;
      const ds=[...new Set(seedsData.filter(x=>x.state===st && x.district).map(x=>x.district))];
      sDistrict.innerHTML=ds.map(d=>`<option>${d}</option>`).join('');
      sDistrict.parentElement.style.display = (st==='Tamil Nadu')?'none':'';
      fillHatch();
    }
    function fillHatch(){
      const st=sState.value, d=sDistrict.value||'';
      const list=seedsData.filter(x=>x.state===st && (st==='Tamil Nadu' || x.district===d));
      sHatch.innerHTML = list.map(x=>`<option data-price="${x.price}" data-bonus="${x.bonusPct}">${x.hatchery}</option>`).join('');
      updPriceBonus();
    }
    function updPriceBonus(){
      const opt=sHatch.selectedOptions[0];
      const price = opt ? +opt.dataset.price : 0;
      const bonus = opt ? +opt.dataset.bonus : 0;
      sPrice.value = price || '';
      sBonusPct.textContent = `${bonus}%`;
      sBonusBadge.textContent = `Bonus ‚Äî ${bonus}%`;
      updateTotals();
    }

    sState.onchange=fillDistrict;
    sDistrict.onchange=fillHatch;
    sHatch.onchange=updPriceBonus;
    sQty.oninput=updateTotals;

    // ---------- Totals ----------
    function updateTotals(){
      const pricePerK = +sPrice.value || 0;
      const qtyPieces = +sQty.value || 0;     // pcs
      const bonusPct = parseInt((sBonusPct.textContent||'0').replace('%',''))||0;
      const totalSeeds = Math.floor(qtyPieces + (qtyPieces * bonusPct/100));
      const amount = Math.round((qtyPieces/1000) * pricePerK);
      sTotalSeeds.textContent = totalSeeds.toLocaleString('en-IN');
      sAmount.textContent = `‚Çπ ${amount.toLocaleString('en-IN')}`;
      sGrand.textContent = sAmount.textContent;
      validateForm();
    }

    // ---------- OTP demo flow ----------
    let currentOTP=null, otpOk=false, resendTimer=null, left=0;
    const validMobile = n => /^[6-9]\d{9}$/.test(n||'');

    sendOtp.addEventListener('click',()=>{
      if(!validMobile(mobile.value)){
        otpHint.textContent = (dict[localStorage.getItem('lang')||'te'].otp_invalid);
        otpStatus.textContent=''; return;
      }
      currentOTP=(''+Math.floor(100000+Math.random()*900000));
      otpOk=false; otpInput.value=''; otpStatus.textContent='';
      otpHint.innerHTML = (dict[localStorage.getItem('lang')||'te'].otp_sent) + '<b>'+currentOTP+'</b>';
      left=30; sendOtp.disabled=true; sendOtp.textContent=`${left}s`;
      resendTimer && clearInterval(resendTimer);
      resendTimer=setInterval(()=>{left--;sendOtp.textContent=`${left}s`; if(left<=0){clearInterval(resendTimer);sendOtp.disabled=false;sendOtp.textContent=dict[localStorage.getItem('lang')||'te'].send_otp;}},1000);
      validateForm();
    });

    verifyOtp.addEventListener('click',()=>{
      const L=dict[localStorage.getItem('lang')||'te'];
      if(otpInput.value===currentOTP && currentOTP){
        otpOk=true; otpStatus.textContent=L.otp_ok; otpStatus.className='mt-1 text-xs text-emerald-600';
      }else{
        otpOk=false; otpStatus.textContent=L.otp_wrong; otpStatus.className='mt-1 text-xs text-rose-600';
      }
      validateForm();
    });

    function validateForm(){
      const okMobile = validMobile(mobile.value) && otpOk;
      const okAddr = (address.value||'').trim().length>0;
      sBook.disabled = !(okMobile && okAddr);
    }
    mobile.addEventListener('input',()=>{otpOk=false; otpStatus.textContent=''; validateForm();});
    address.addEventListener('input',validateForm);

    // Book
    sBook.addEventListener('click',()=>{
      if(sBook.disabled) return;
      const msg =
        `Seeds Booking\n`+
        `‚Ä¢ ${sState.value} ${sDistrict.parentElement.style.display==='none'?'':sDistrict.value}\n`+
        `‚Ä¢ ${sHatch.value} @ ‚Çπ${sPrice.value}/1000 | Bonus ${sBonusPct.textContent}\n`+
        `‚Ä¢ Qty: ${(+sQty.value||0).toLocaleString('en-IN')} pcs | Total: ${sTotalSeeds.textContent}\n`+
        `‚Ä¢ Amount: ${sAmount.textContent}\n`+
        `‚Ä¢ Mobile: +91 ${mobile.value}\n`+
        `‚Ä¢ Address: ${address.value}`;
      alert('‚úÖ ' + msg);
      // For WhatsApp, replace alert with:
      // window.open('https://wa.me/91XXXXXXXXXX?text='+encodeURIComponent(msg),'_blank');
    });

    // INIT
    (function(){
      if(!localStorage.getItem('lang')) localStorage.setItem('lang','te');
      setLang();
      fillDistrict();
      sQty.value = 0;      // default 0
      updateTotals();
    })();
  </script>
</body>
</html>
